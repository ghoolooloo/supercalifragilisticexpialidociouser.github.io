---
title: Smalltalk
date: 2018-08-29 10:29:20
tags:
---

# 简介

Smalltalk是一个面向对象的、动态类型的编程语言。

IDE：[Pharo](https://pharo.org/)

# 词法

## 字符集

- a-z
- A-Z
- 0-9
- .+/*~<>@%|&?
- blank, tab, cr, ff, lf

## 标识符

全局变量的首字母必须大写，局部变量的首字母必须小写。

## 关键字

关键字实际上是以冒号结尾的标识符（例如`keyword:`），它只有在它形成“关键字消息”的时候才有意义。

## 保留字

 `nil`、`true`、`false`、`self`、`super`和`Smalltalk`

## 数值

```smalltalk
5        "十进制数5"
16r7f    "十六进制数7f"
基数r111 "任意进制数11"
2e-5     "浮点数"
22/7     "分数"
```

## 字符

```smalltalk
$h    "字符h"
$     "$后跟一个空格表示空格字符"
```

## 字符串

```smalltalk
'这是字符串'
'I''m here'
```

字符串中的单引号，使用两个单引号（`''`）表示。

## 布尔值

`true`：`True`类的唯一实例。

`false`：`False`类的唯一实例。

## 空值

 `nil`：代表未初始化的值。

## 符号

```smalltalk
#red    "符号red"
```

## 注释

```smalltalk
"这是注释"
```

# 声明

Smalltalk中的变量是没有类型的，即它可以引用任意类型对象。因此，声明变量时，不需要指定类型。

Smalltalk的对象是有类型的（实际上是类）。

## 作用域

### 全局作用域

在`Smalltalk`字典中定义，对所有对象可见。

### 方法临时作用域

在方法内部声明，只在方法内部可见。

方法的所有局部变量要在方法体的开头处声明。

### 块临时作用域

在块中声明，只在块中可见。

### Pool作用域

在字典对象中的变量。

### 方法参数作用域

### 块参数作用域

### 类作用域

### 实例作用域



### 实例变量作用域

实例变量只在对象中可见，相当于私有成员变量。

实例变量命名，约定以小写字母开始。

## 局部变量声明

```smalltalk
| x y |
```

声明了两个局部变量`x`和`y`。

# 块

块（也叫闭包）也是对象。

除非有显式的返回，否则块的值是它的最后一个表达式的值 。

块可以嵌套。

块的一般形式：

```smalltalk
[ 参数 | 局部变量声明 表达式 ]
```



无参块：

```smalltalk
[ y := 1. z := 2. ]
```

## 返回值

```smalltalk
^ 返回对象
```



# 消息

消息实际上就是方法调用。

## 一元消息

```smalltalk
object unaryMessage     "相当于Java：object.unaryMessage()"
myDept manager name last  "相当于Java：myDept.manager().name().last()"
```

## 二元消息



# 集合

## 数组

### 数组字面量

```smalltalk
#('abc' 2 $a)  "数组字面量"
```



## 一元消息

# 语句

语句使用`.`作为分隔符。

## 赋值

```smalltalk
x := 5.
x := y := z := 6.
x := (y := 6) + 1.
```

